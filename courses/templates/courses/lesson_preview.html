<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Превью урока</title>
    
    {% load static %}
    {% load importmap_tags %}
    {% importmap_script %}
    
    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Base Styles -->
    <style>
        body {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            background-color: #f8f9fa;
            font-family: 'Montserrat', 'Segoe UI', 'Helvetica', 'Arial', sans-serif;
        }
    </style>
    <link rel="stylesheet" href="{% static 'css/base.css' %}">
    <link rel="stylesheet" href="{% static 'css/tasks_styles.css' %}">
</head>
<body>
    <div id="info"
         data-is-teacher="false"
         data-lesson-id="{{ lesson_id }}"
         data-lesson-type="preview"
         data-is-classroom="false"
         data-current-user-id="{{ current_user_id }}"
         data-viewed-user-id="{{ current_user_id }}"
    >
    </div>

    <script type="module">
        import { loadSectionTasks } from "{% static 'js/tasks/display/showTasks.js' %}";
    </script>

    <script type="module">
        import { initRenderSections } from "{% static 'js/tasks/display/renderSections.js' %}";

        document.addEventListener("DOMContentLoaded", () => {
            initRenderSections();
        });
    </script>

    <script type="module">
        import { registerAnswerEvents } from "{% static 'classroom/answers/handleAnswer.js' %}";

        registerAnswerEvents();
    </script>

    <script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']],
            displayMath: [['$$','$$'], ['\\[','\\]']],
            packages: {'[+]': ['autoload']}
        },
        output: {
            displayOverflow: 'linebreak',
            linebreaks: {
                automatic: true,
                width: '100%'
            }
        },
        options: {
            skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
    };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>

    <div class="container-fluid py-4">
        <div class="row mt-4 d-flex justify-content-center">
            <div id="main-container" class="col-12 col-xl-9">
                <div id="task-list" class="bg-white p-3 rounded shadow-sm" style="min-height: 400px;"></div>
            </div>

            <div id="sidebar" class="col-12 col-xl-3 my-4 my-xl-0">
                <div class="card shadow-sm rounded p-2" style="max-height: 40vh; overflow-y: hidden;">
                    <ul id="section-list"
                        class="list-group list-group-flush py-1"
                        style="overflow-y: auto; max-height: calc(40vh - 60px);">
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div id="notification-container"
         class="position-fixed bottom-0 start-0 mb-3 ms-3 d-flex flex-column-reverse gap-2"
         style="z-index: 1155; max-height: 60vh; max-width: 70vw; overflow-y: auto;">
    </div>
</body>
</html>